!function(e){"use strict";e.jscroll={defaults:{debug:!1,autoTrigger:!0,autoTriggerUntil:!1,loadingHtml:"<small>Loading...</small>",loadingFunction:!1,padding:0,nextSelector:"a:last",contentSelector:"",pagingSelector:"",callback:!1}};var t=function(t,n){var o,i=t.data("jscroll"),l="function"==typeof n?{callback:n}:n,r=e.extend({},e.jscroll.defaults,l,i||{}),c="visible"===t.css("overflow-y"),a=t.find(r.nextSelector).first(),s=e(window),d=e("body"),f=c?s:t,g=e.trim(a.prop("href")+" "+r.contentSelector),u=function(){t.find(".feed-inner").length||t.contents().wrapAll('<div class="feed-inner" />')},p=function(e){r.pagingSelector?e.closest(r.pagingSelector).hide():e.parent().not(".feed-inner,.eyeshot-feed").addClass("jscroll-next-parent").hide().length||e.wrap('<div class="jscroll-next-parent" />').parent().hide()},h=function(){return f.unbind(".jscroll").removeData("jscroll").find(".feed-inner").children().unwrap().filter(".eyeshot-feed").children().unwrap()},j=function(){if(t.is(":visible")){u();var e=t.find("div.feed-inner").first(),n=t.data("jscroll"),o=parseInt(t.css("borderTopWidth"),10),i=isNaN(o)?0:o,l=parseInt(t.css("paddingTop"),10)+i,a=c?f.scrollTop():t.offset().top,s=e.length?e.offset().top:0,d=Math.ceil(a-s+f.height()+l);if(!n.waiting&&d+r.padding>=e.outerHeight())return b("info","jScroll:",e.outerHeight()-d,"from bottom. Loading next request..."),y()}},v=function(){var n=t.find(r.nextSelector).first();if(n.length)if(r.autoTrigger&&(!1===r.autoTriggerUntil||0<r.autoTriggerUntil)){p(n);var o=d.height()-t.offset().top;(t.height()<o?t.height():o)<=(0<t.offset().top-s.scrollTop()?s.height()-(t.offset().top-e(window).scrollTop()):s.height())&&j(),f.unbind(".jscroll").bind("scroll.jscroll",function(){return j()}),0<r.autoTriggerUntil&&r.autoTriggerUntil--}else f.unbind(".jscroll"),n.bind("click.jscroll",function(){return p(n),y(),!1})},y=function(){var n=t.find("div.feed-inner").first(),o=t.data("jscroll");return o.waiting=!0,n.append('<div class="eyeshot-feed" />').children(".eyeshot-feed").last().html('<div class="jscroll-loading" id="jscroll-loading">'+r.loadingHtml+"</div>").promise().done(function(){r.loadingFunction&&r.loadingFunction()}),t.animate({scrollTop:n.outerHeight()},0,function(){var i=o.nextHref;n.find("div.eyeshot-feed").last().load(i,function(n,l){if("error"===l)return h();var c,a=e(this).find(r.nextSelector).first();o.waiting=!1,o.nextHref=!!a.prop("href")&&e.trim(a.prop("href")+" "+r.contentSelector),e(".jscroll-next-parent",t).remove(),(c=c||t.data("jscroll"))&&c.nextHref?v():(b("warn","jScroll: nextSelector not found - destroying"),h()),r.callback&&r.callback.call(this,i),b("dir",o)})})},b=function(e){if(r.debug&&"object"==typeof console&&("object"==typeof e||"function"==typeof console[e]))if("object"==typeof e){var t=[];for(var n in e)"function"==typeof console[n]?(t=e[n].length?e[n]:[e[n]],console[n].apply(console,t)):console.log.apply(console,t)}else console[e].apply(console,Array.prototype.slice.call(arguments,1))};return t.data("jscroll",e.extend({},i,{initialized:!0,waiting:!1,nextHref:g})),u(),(o=e(r.loadingHtml).filter("img").attr("src"))&&((new Image).src=o),v(),e.extend(t.jscroll,{destroy:h}),t};e.fn.jscroll=function(n){return this.each(function(){var o=e(this),i=o.data("jscroll");i&&i.initialized||t(o,n)})}}(jQuery);